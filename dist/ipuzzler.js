!function(){var t={713:function(t){t.exports=function(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}}},n={};function e(i){if(n[i])return n[i].exports;var r=n[i]={exports:{}};return t[i](r,r.exports,e),r.exports}e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,{a:n}),n},e.d=function(t,n){for(var i in n)e.o(n,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:n[i]})},e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},function(){var t;e.g.importScripts&&(t=e.g.location+"");var n=e.g.document;if(!t&&n&&(n.currentScript&&(t=n.currentScript.src),!t)){var i=n.getElementsByTagName("script");i.length&&(t=i[i.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t}(),function(){"use strict";var t=e(713),n=e.n(t);function i(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,i)}return e}function r(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?i(Object(r),!0).forEach((function(e){n()(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))}))}return t}!function(){function t(t,n){var e=this;this.direction=(n||t.direction||"").toLowerCase(),t&&(this.text=t.clue||"",this.number=t.number||0,this.enumeration=(t.enumeration||"").replace(/ /g,","),this.label=t.label||this.number),this.root=null,this.next=null,this.continuations=[],this.cells=[],this.toClueList=function(t){return[e].concat(e.continuations)},this.toListItem=function(){var t='<a href="#"><label>'.concat(this.label,"</label>").concat(this.text);this.enumeration&&(t+=" <span>(".concat(this.enumeration,")</span>")),t+="</a>";var n=document.createElement("li");return n.innerHTML=t,n},this.highlight=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(0==t&&this.root)return this.root.highlight(t+1);this.cells.forEach((function(t){return t.highlight()})),this.continuations.forEach((function(n){return n.highlight(t+1)}))},this.focusFirstInput=function(){this.cells[0].focus()},this.focusFinalInput=function(){this.cells[this.cells.length-1].focus()}}function n(t,n,e){var i=this;this.position={x:t,y:n},this.span=document.createElement("span"),this.span.className="cell",this.previous={},this.next={},this.clues=[],null===e?this.span.className+=" null":(this.style=e.style||{},e.style&&e.style.barred&&(this.span.className+=" barred-"+e.style.barred.toLowerCase()),this.value=e.cell||e,parseInt(this.value)&&this.span.insertAdjacentHTML("afterbegin",'<span class="clue-number">'.concat(this.value,"</span>")),"#"==this.value?this.span.className+=" block":(this.input=document.createElement("input"),this.input.setAttribute("maxlength","1"),this.input.cell=this,this.span.appendChild(this.input))),this.isEndOfRange=function(t){return!this.input||!("across"!=t||!/L/i.test(this.style.barred))||!("down"!=t||!/T/i.test(this.style.barred))},this.highlight=function(){return i.span.classList.add("current-clue")},this.clearHighlight=function(){return i.span.classList.remove("current-clue")},this.focus=function(){return i.input.focus()}}function e(e){this.direction="across",this.changeDirection=function(t){console.log("changin direction!"),this.direction=t||("across"==this.direction?"down":"across")};var i=function t(n,e,i,r){if(e<0||n<0||e>=o.cells.length||n>=o.cells[e].length)return[];var s=o.cells[e][n];return s.previous[i]=r,s.isEndOfRange()?[]:(r&&(r.next[i]=s),"across"==i?n++:e++,[s].concat(t(n,e,i,s)))};function r(t,n){var e=document.createElement("div");e.innerHTML="<h2>".concat(t,"</h2>");var i=document.createElement(i);return n.forEach((function(t){return i.appendChild(t.toListItem())})),e.appendChild(i),e}this.drawPuzzle=function(s){this.cells=function(t){return t.puzzle.map((function(t,e){return t.map((function(t,i){return new n(i,e,t)}))}))}(s),this.clues=function(n){var e=n.clues.Across.map((function(n){return t.parse(n,"across").toClueList()})).flat(),r=n.clues.Down.map((function(n){return t.parse(n,"down").toClueList()})).flat(),s={across:[],down:[]};return e.concat(r).forEach((function(t){t.position=function(t){return o.cells.flat().find((function(n){return n.value==t.number})).position}(t),t.cells=i(t.position.x,t.position.y,t.direction),t.cells.forEach((function(n){return n.clues.push(t)})),s[t.direction][t.number]=t})),s}(s);var c,u,l=document.createElement("div");l.className="puzzle-layout",this.grid=(c=this.cells,(u=document.createElement("div")).className="puzzle-grid",c.forEach((function(t){return t.forEach((function(t){return u.appendChild(t.span)}))})),u),l.appendChild(this.grid),l.appendChild(r("Across",this.clues.across)),l.appendChild(r("Down",this.clues.down)),e.appendChild(l),e.addEventListener("keypress",this.handleKeyPress),e.addEventListener("keydown",this.handleKeyDown),e.addEventListener("focusin",this.handleFocus),e.addEventListener("click",this.handleClick),this.grid.style.gridTemplate="repeat(".concat(s.dimensions.height,", 1fr) / repeat(").concat(s.dimensions.width,", 1fr)"),window.innerWidth>768&&(this.grid.style.width=32*s.dimensions.width+"px",this.grid.style.height=32*s.dimensions.height+"px"),this.handleWindowResize()};var o=this;this.findCluesForInput=function(t,n){return o.cells.flat().find((function(n){return n.input===t})).clues},this.clearHighlights=function(){o.cells.flat().forEach((function(t){return t.clearHighlight()}))},this.moveFocusToNextCell=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.direction;return function(n){var e=n.target.cell;if(e.next&&e.next[t])o.changeDirection(t),e.next[t].focus();else{var i=o.findCluesForInput(n.target).find((function(n){return n.direction==t}));i&&i.next&&(o.changeDirection(i.next.direction),i.next.focusFirstInput())}}},this.moveFocusToPreviousCell=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.direction;return function(n){var e=n.target.cell;e.previous&&e.previous[t]&&(o.changeDirection(t),e.previous[t].focus())}},this.focusFirstInput=function(t){o.findCluesForInput(t.target).find((function(t){return t.direction==o.direction})).focusFirstInput()},this.focusFinalInput=function(t){var n=o.findCluesForInput(t.target);console.log(n),n.find((function(t){return t.direction==o.direction})).focusFinalInput()},this.keyHandlers={ArrowLeft:this.moveFocusToPreviousCell("across"),ArrowRight:this.moveFocusToNextCell("across"),ArrowUp:this.moveFocusToPreviousCell("down"),ArrowDown:this.moveFocusToNextCell("down"),Home:this.focusFirstInput,End:this.focusFinalInput},this.handleKeyDown=function(t){var n=o.keyHandlers[t.key];if(n)return n(t)},this.handleFocus=function(t){window.focusing=!0,o.clearHighlights();var n=o.findCluesForInput(t.target);console.log("handleFocus"),console.log(o.direction);var e=n.find((function(t){return t.direction==o.direction}));e||(o.changeDirection(),e=n.find((function(t){return t.direction==o.direction}))),e.highlight(),window.setTimeout((function(){return window.focusing=!1}),200)},this.handleKeyPress=function(t){console.log(t),console.log(this)},this.handleClick=function(t){if(!window.focusing&&"INPUT"==t.target.tagName){var n=o.findCluesForInput(t.target);n.length>1&&o.changeDirection(),o.clearHighlights(),n.find((function(t){return t.direction==o.direction})).highlight()}},this.handleWindowResize=function(t){if(o.grid){var n=parseInt(getComputedStyle(o.grid,null).width.replace("px","")),e=Math.ceil(n/(2*o.cells[0].length));e>10&&e<16&&(e=16),o.grid.querySelectorAll("input").forEach((function(t){return t.style.fontSize=e+"px"}));var i=Math.ceil(n/(3.5*o.cells[0].length));o.grid.querySelectorAll("span.clue-number").forEach((function(t){return t.style.fontSize=i+"px"}))}},window.addEventListener("resize",this.handleWindowResize)}var i,o;t.parse=function(n,e){var i=new t(n,e);if(n.continued&&n.continued.map){i.continuations=n.continued.map((function(e){return r(r({},t.parse(e)),{},{text:"See ".concat(n.number),root:i})})),i.next=i.continuations[0];for(var o=0;o<i.continuations.length-1;o++)i.continuations[o].next=i.continuations[o+1]}return i},window.ipuzzler=function(t){var n=new e(document.querySelector(t));return this.load=function(t){!function(t,e,i,r){var o=new XMLHttpRequest;o.open("GET",t,!0),o.onload=function(){var t;o.status>=200&&o.status<400&&(t=JSON.parse(o.responseText),n.drawPuzzle(t))},o.send()}(t)},this},i=window,o={},window.location.search.replace(/^\?/,"").split("&").forEach((function(t){var n=t.split("=");o[n[0]]=n[1]})),i.query=o}()}(),function(){"use strict";e.p}()}();
//# sourceMappingURL=ipuzzler.js.map