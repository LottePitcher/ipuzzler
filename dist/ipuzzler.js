!function(){var t={713:function(t){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}}},e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={exports:{}};return t[i](r,r.exports,n),r.exports}n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},n.d=function(t,e){for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var i=e.getElementsByTagName("script");i.length&&(t=i[i.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t}(),function(){"use strict";var t=n(713),e=n.n(t);function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function r(t){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?i(Object(r),!0).forEach((function(n){e()(t,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}!function(){function t(t,e){var n=this;this.direction=(e||t.direction||"").toLowerCase(),t&&(this.text=t.clue||"",this.number=t.number||0,this.enumeration=(t.enumeration||"").replace(/ /g,","),this.label=t.label||this.number),this.root=null,this.next=null,this.continuations=[],this.cells=[],this.toClueList=function(t){return[n].concat(n.continuations)},this.toListItem=function(){var t='<a href="#"><label>'.concat(this.label,"</label>").concat(this.text);this.enumeration&&(t+=" <span>(".concat(this.enumeration,")</span>")),t+="</a>";var e=document.createElement("li");return e.innerHTML=t,e},this.highlight=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(0==t&&this.root)return this.root.highlight(t+1);this.cells.forEach((function(t){return t.highlight()})),this.continuations.forEach((function(e){return e.highlight(t+1)}))}}function e(t,e,n){var i=this;this.position={x:t,y:e},this.span=document.createElement("span"),this.span.className="cell",this.previous={},this.next={},this.clues={},null===n?this.span.className+=" null":(this.style=n.style||{},n.style&&n.style.barred&&(this.span.className+=" barred-"+n.style.barred.toLowerCase()),this.value=n.cell||n,parseInt(this.value)&&this.span.insertAdjacentHTML("afterbegin",'<span class="clue-number">'.concat(this.value,"</span>")),"#"==this.value?this.span.className+=" block":(this.input=document.createElement("input"),this.input.setAttribute("maxlength","1"),this.input.cell=this,this.span.appendChild(this.input))),this.isEndOfRange=function(t){return!this.input||!("across"!=t||!/L/i.test(this.style.barred))||!("down"!=t||!/T/i.test(this.style.barred))},this.highlight=function(){return i.span.classList.add("current-clue")},this.clearHighlight=function(){return i.span.classList.remove("current-clue")}}function n(n){this.direction="across",this.changeDirection=function(){this.direction="across"==this.direction?"down":"across"};var i=function t(e,n,i,r){if(n<0||e<0||n>=s.cells.length||e>=s.cells[n].length)return[];var o=s.cells[n][e];return o.previous[i]=r,o.isEndOfRange()?[]:(r&&(r.next[i]=o),"across"==i?e++:n++,[o].concat(t(e,n,i,o)))};function r(t,e){var n=document.createElement("div");n.innerHTML="<h2>".concat(t,"</h2>");var i=document.createElement(i);return e.forEach((function(t){return i.appendChild(t.toListItem())})),n.appendChild(i),n}this.drawPuzzle=function(o){this.cells=function(t){return t.puzzle.map((function(t,n){return t.map((function(t,i){return new e(i,n,t)}))}))}(o),this.clues=function(e){var n=e.clues.Across.map((function(e){return t.parse(e,"across").toClueList()})).flat(),r=e.clues.Down.map((function(e){return t.parse(e,"down").toClueList()})).flat(),o={across:[],down:[]};return n.concat(r).forEach((function(t){t.position=function(t){return s.cells.flat().find((function(e){return e.value==t.number})).position}(t),t.cells=i(t.position.x,t.position.y,t.direction),t.cells.forEach((function(e){return e.clues[t.direction]=t})),o[t.direction][t.number]=t})),o}(o);var c,a,u=document.createElement("div");u.className="puzzle-layout",this.grid=(c=this.cells,(a=document.createElement("div")).className="puzzle-grid",c.forEach((function(t){return t.forEach((function(t){return a.appendChild(t.span)}))})),a),u.appendChild(this.grid),u.appendChild(r("Across",this.clues.across)),u.appendChild(r("Down",this.clues.down)),n.appendChild(u),n.addEventListener("keypress",this.handleKeyPress),n.addEventListener("keydown",this.handleKeyDown),n.addEventListener("focusin",this.handleFocus),n.addEventListener("click",this.handleClick),this.grid.style.gridTemplate="repeat(".concat(o.dimensions.height,", 1fr) / repeat(").concat(o.dimensions.width,", 1fr)"),window.innerWidth>768&&(this.grid.style.width=32*o.dimensions.width+"px",this.grid.style.height=32*o.dimensions.height+"px"),this.handleWindowResize()};var s=this;this.findCluesForInput=function(t){return s.cells.flat().find((function(e){return e.input===t})).clues},this.clearHighlights=function(){s.cells.flat().forEach((function(t){return t.clearHighlight()}))},this.handleFocus=function(t){window.focusing=!0,s.clearHighlights();var e=s.findCluesForInput(t.target);e[s.direction]||s.changeDirection(),e[s.direction].highlight(),window.setTimeout((function(){return window.focusing=!1}),200)},this.handleKeyDown=function(t){console.log(t),console.log(this)},this.handleKeyPress=function(t){console.log(t),console.log(this)},this.handleClick=function(t){if(!window.focusing&&"INPUT"==t.target.tagName){var e=s.findCluesForInput(t.target);e.across&&e.down&&s.changeDirection(),s.clearHighlights(),e[s.direction].highlight()}},this.handleWindowResize=function(t){if(s.grid){var e=parseInt(getComputedStyle(s.grid,null).width.replace("px","")),n=Math.ceil(e/(2*s.cells[0].length));n>10&&n<16&&(n=16),s.grid.querySelectorAll("input").forEach((function(t){return t.style.fontSize=n+"px"}));var i=Math.ceil(e/(3.5*s.cells[0].length));s.grid.querySelectorAll("span.clue-number").forEach((function(t){return t.style.fontSize=i+"px"}))}},window.addEventListener("resize",this.handleWindowResize)}var i,s;t.parse=function(e,n){var i=new t(e,n);if(e.continued&&e.continued.map){i.continuations=e.continued.map((function(n){return r(r({},t.parse(n)),{},{text:"See ".concat(e.number),root:i})}));for(var s=0;s<i.continuations.length-1;s++)i.continuations[s].next=i.continuations[s+1]}return i},window.ipuzzler=function(t){var e=new n(document.querySelector(t));return this.load=function(t){!function(t,n,i,r){var s=new XMLHttpRequest;s.open("GET",t,!0),s.onload=function(){var t;s.status>=200&&s.status<400&&(t=JSON.parse(s.responseText),e.drawPuzzle(t))},s.send()}(t)},this},i=window,s={},window.location.search.replace(/^\?/,"").split("&").forEach((function(t){var e=t.split("=");s[e[0]]=e[1]})),i.query=s}()}(),function(){"use strict";n.p}()}();
//# sourceMappingURL=ipuzzler.js.map