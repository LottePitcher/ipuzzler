{"version":3,"sources":["webpack://webpax/./node_modules/@babel/runtime/helpers/defineProperty.js","webpack://webpax/webpack/bootstrap","webpack://webpax/webpack/runtime/compat get default export","webpack://webpax/webpack/runtime/define property getters","webpack://webpax/webpack/runtime/global","webpack://webpax/webpack/runtime/hasOwnProperty shorthand","webpack://webpax/webpack/runtime/publicPath","webpack://webpax/./src/ipuzzler.js","webpack://webpax/./src/ipuzzler.scss"],"names":["module","exports","obj","key","value","Object","defineProperty","enumerable","configurable","writable","__webpack_module_cache__","__webpack_require__","moduleId","__webpack_modules__","n","getter","__esModule","d","a","definition","o","get","g","globalThis","this","Function","e","window","prop","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","src","scripts","getElementsByTagName","length","Error","replace","p","Clue","ipuzClueData","direction","toLowerCase","text","clue","number","enumeration","label","root","next","continuations","cells","toClueList","_","concat","toListItem","html","li","createElement","innerHTML","highlight","depth","forEach","cell","Cell","x","y","ipuzCellData","position","span","className","previous","clues","style","barred","parseInt","insertAdjacentHTML","input","setAttribute","appendChild","isEndOfRange","test","classList","add","clearHighlight","remove","Puzzle","container","changeDirection","listCells","puzzle","drawClues","heading","div","ul","drawPuzzle","ipuz","map","row","ipuzCell","parseCells","cluesFromAcross","Across","c","parse","flat","cluesFromDown","Down","across","down","find","findCluePosition","parseClues","grid","layout","addEventListener","handleKeyPress","handleKeyDown","handleFocus","handleClick","gridTemplate","dimensions","height","width","innerWidth","handleWindowResize","findCluesForInput","clearHighlights","event","focusing","target","setTimeout","console","log","tagName","gridSize","getComputedStyle","fontSize","Math","ceil","querySelectorAll","clueFontSize","w","query","ipuzClue","continued","i","ipuzzler","selector","querySelector","load","url","success","failure","error","request","XMLHttpRequest","open","onload","data","status","JSON","responseText","send","search","split","token","pair"],"mappings":"mCAeAA,EAAOC,QAfP,SAAyBC,EAAKC,EAAKC,GAYjC,OAXID,KAAOD,EACTG,OAAOC,eAAeJ,EAAKC,EAAK,CAC9BC,MAAOA,EACPG,YAAY,EACZC,cAAc,EACdC,UAAU,IAGZP,EAAIC,GAAOC,EAGNF,KCXLQ,EAA2B,GAG/B,SAASC,EAAoBC,GAE5B,GAAGF,EAAyBE,GAC3B,OAAOF,EAAyBE,GAAUX,QAG3C,IAAID,EAASU,EAAyBE,GAAY,CAGjDX,QAAS,IAOV,OAHAY,EAAoBD,GAAUZ,EAAQA,EAAOC,QAASU,GAG/CX,EAAOC,QCnBfU,EAAoBG,EAAI,SAASd,GAChC,IAAIe,EAASf,GAAUA,EAAOgB,WAC7B,WAAa,OAAOhB,EAAgB,SACpC,WAAa,OAAOA,GAErB,OADAW,EAAoBM,EAAEF,EAAQ,CAAEG,EAAGH,IAC5BA,GCLRJ,EAAoBM,EAAI,SAAShB,EAASkB,GACzC,IAAI,IAAIhB,KAAOgB,EACXR,EAAoBS,EAAED,EAAYhB,KAASQ,EAAoBS,EAAEnB,EAASE,IAC5EE,OAAOC,eAAeL,EAASE,EAAK,CAAEI,YAAY,EAAMc,IAAKF,EAAWhB,MCJ3EQ,EAAoBW,EAAI,WACvB,GAA0B,iBAAfC,WAAyB,OAAOA,WAC3C,IACC,OAAOC,MAAQ,IAAIC,SAAS,cAAb,GACd,MAAOC,GACR,GAAsB,iBAAXC,OAAqB,OAAOA,QALjB,GCAxBhB,EAAoBS,EAAI,SAASlB,EAAK0B,GAAQ,OAAOvB,OAAOwB,UAAUC,eAAeC,KAAK7B,EAAK0B,I,WCA/F,IAAII,EACArB,EAAoBW,EAAEW,gBAAeD,EAAYrB,EAAoBW,EAAEY,SAAW,IACtF,IAAIC,EAAWxB,EAAoBW,EAAEa,SACrC,IAAKH,GAAaG,IACbA,EAASC,gBACZJ,EAAYG,EAASC,cAAcC,MAC/BL,GAAW,CACf,IAAIM,EAAUH,EAASI,qBAAqB,UACzCD,EAAQE,SAAQR,EAAYM,EAAQA,EAAQE,OAAS,GAAGH,KAK7D,IAAKL,EAAW,MAAM,IAAIS,MAAM,yDAChCT,EAAYA,EAAUU,QAAQ,OAAQ,IAAIA,QAAQ,QAAS,IAAIA,QAAQ,YAAa,KACpF/B,EAAoBgC,EAAIX,E,mnBCfxB,WAEI,SAASY,EAAKC,EAAcC,GAAW,WACnCtB,KAAKsB,WAAaA,GAAaD,EAAaC,WAAa,IAAIC,cACzDF,IACArB,KAAKwB,KAAOH,EAAaI,MAAQ,GACjCzB,KAAK0B,OAASL,EAAaK,QAAU,EACrC1B,KAAK2B,aAAeN,EAAaM,aAAe,IAAIT,QAAQ,KAAM,KAClElB,KAAK4B,MAAQP,EAAaO,OAAS5B,KAAK0B,QAE5C1B,KAAK6B,KAAO,KACZ7B,KAAK8B,KAAO,KACZ9B,KAAK+B,cAAgB,GACrB/B,KAAKgC,MAAQ,GACbhC,KAAKiC,WAAa,SAAAC,GAAC,MAAI,CAAC,GAAMC,OAAO,EAAKJ,gBAE1C/B,KAAKoC,WAAa,WACd,IAAIC,EAAO,sBAAH,OAAyBrC,KAAK4B,MAA9B,mBAA8C5B,KAAKwB,MACvDxB,KAAK2B,cAAaU,GAAQ,WAAJ,OAAerC,KAAK2B,YAApB,aAC1BU,GAAQ,OACR,IAAMC,EAAK3B,SAAS4B,cAAc,MAElC,OADAD,EAAGE,UAAYH,EACPC,GAGZtC,KAAKyC,UAAY,WAAqB,IAAXC,EAAW,uDAAH,EAC/B,GAAa,GAATA,GAAc1C,KAAK6B,KACnB,OAAO7B,KAAK6B,KAAKY,UAAUC,EAAQ,GAEnC1C,KAAKgC,MAAMW,SAAQ,SAAAC,GAAI,OAAIA,EAAKH,eAChCzC,KAAK+B,cAAcY,SAAQ,SAAAlB,GAAI,OAAIA,EAAKgB,UAAUC,EAAQ,OActE,SAASG,EAAKC,EAAGC,EAAGC,GAAc,WAC9BhD,KAAKiD,SAAW,CAAEH,EAAGA,EAAGC,EAAGA,GAC3B/C,KAAKkD,KAAOvC,SAAS4B,cAAc,QACnCvC,KAAKkD,KAAKC,UAAY,OACtBnD,KAAKoD,SAAW,GAChBpD,KAAK8B,KAAO,GACZ9B,KAAKqD,MAAQ,GACQ,OAAjBL,EACAhD,KAAKkD,KAAKC,WAAa,SAEvBnD,KAAKsD,MAAQN,EAAaM,OAAS,GAC/BN,EAAaM,OAASN,EAAaM,MAAMC,SAAQvD,KAAKkD,KAAKC,WAAa,WAAaH,EAAaM,MAAMC,OAAOhC,eACnHvB,KAAKpB,MAASoE,EAAaJ,MAAQI,EAC/BQ,SAASxD,KAAKpB,QAAQoB,KAAKkD,KAAKO,mBAAmB,aAA7B,oCAAwEzD,KAAKpB,MAA7E,YACR,KAAdoB,KAAKpB,MACLoB,KAAKkD,KAAKC,WAAa,UAEvBnD,KAAK0D,MAAQ/C,SAAS4B,cAAc,SACpCvC,KAAK0D,MAAMC,aAAa,YAAa,KACrC3D,KAAK0D,MAAMd,KAAO5C,KAClBA,KAAKkD,KAAKU,YAAY5D,KAAK0D,SAInC1D,KAAK6D,aAAe,SAAUvC,GAC1B,OAAKtB,KAAK0D,SACO,UAAbpC,IAAyB,KAAKwC,KAAK9D,KAAKsD,MAAMC,YACjC,QAAbjC,IAAuB,KAAKwC,KAAK9D,KAAKsD,MAAMC,UAIpDvD,KAAKyC,UAAY,kBAAM,EAAKS,KAAKa,UAAUC,IAAI,iBAC/ChE,KAAKiE,eAAiB,kBAAM,EAAKf,KAAKa,UAAUG,OAAO,iBAI3D,SAASC,EAAOC,GAEZpE,KAAKsB,UAAY,SAEjBtB,KAAKqE,gBAAkB,WACnBrE,KAAKsB,UAA+B,UAAlBtB,KAAKsB,UAAwB,OAAS,UAG5D,IAmBMgD,EAAY,SAAZA,EAAsBxB,EAAGC,EAAGzB,EAAW8B,GACzC,GAAIL,EAAI,GAAKD,EAAI,GAAKC,GAAKwB,EAAOvC,MAAMhB,QAAU8B,GAAKyB,EAAOvC,MAAMe,GAAG/B,OAAQ,MAAO,GACtF,IAAI4B,EAAO2B,EAAOvC,MAAMe,GAAGD,GAE3B,OADAF,EAAKQ,SAAS9B,GAAa8B,EACvBR,EAAKiB,eAAuB,IAC5BT,IAAUA,EAAStB,KAAKR,GAAasB,GAC3B,UAAbtB,EAAwBwB,IAAMC,IACvB,CAACH,GAAMT,OAAOmC,EAAUxB,EAAGC,EAAGzB,EAAWsB,MAUrD,SAAS4B,EAAUC,EAASpB,GACxB,IAAIqB,EAAM/D,SAAS4B,cAAc,OACjCmC,EAAIlC,UAAJ,cAAuBiC,EAAvB,SACA,IAAIE,EAAKhE,SAAS4B,cAAcoC,GAGhC,OAFAtB,EAAMV,SAAQ,SAAAlB,GAAI,OAAIkD,EAAGf,YAAYnC,EAAKW,iBAC1CsC,EAAId,YAAYe,GACTD,EAGX1E,KAAK4E,WAAa,SAAUC,GACxB7E,KAAKgC,MA9CU,SAAC6C,GAAD,OAAUA,EAAKN,OAAOO,KAAI,SAACC,EAAKhC,GAAN,OAAYgC,EAAID,KAAI,SAACE,EAAUlC,GAAX,OAAiB,IAAID,EAAKC,EAAGC,EAAGiC,SA8ChFC,CAAWJ,GACxB7E,KAAKqD,MAzCU,SAAUwB,GACzB,IAAIK,EAAkBL,EAAKxB,MAAM8B,OAAOL,KAAI,SAAAM,GAAC,OAAIhE,EAAKiE,MAAMD,EAAG,UAAUnD,gBAAcqD,OACnFC,EAAgBV,EAAKxB,MAAMmC,KAAKV,KAAI,SAAAM,GAAC,OAAIhE,EAAKiE,MAAMD,EAAG,QAAQnD,gBAAcqD,OAC3EjC,EAAQ,CAAEoC,OAAQ,GAAIC,KAAM,IAOlC,OANAR,EAAgB/C,OAAOoD,GAAe5C,SAAQ,SAAAlB,GAC1CA,EAAKwB,SATY,SAAUxB,GAC/B,OAAO8C,EAAOvC,MAAMsD,OAAOK,MAAK,SAAA/C,GAAI,OAAIA,EAAKhE,OAAS6C,EAAKC,UAAQuB,SAQ/C2C,CAAiBnE,GACjCA,EAAKO,MAAQsC,EAAU7C,EAAKwB,SAASH,EAAGrB,EAAKwB,SAASF,EAAGtB,EAAKH,WAC9DG,EAAKO,MAAMW,SAAQ,SAAAC,GAAI,OAAIA,EAAKS,MAAM5B,EAAKH,WAAaG,KACxD4B,EAAM5B,EAAKH,WAAWG,EAAKC,QAAUD,KAElC4B,EA+BMwC,CAAWhB,GACxB,IAnBc7C,EACR8D,EAkBAC,EAASpF,SAAS4B,cAAc,OACtCwD,EAAO5C,UAAY,gBACnBnD,KAAK8F,MArBS9D,EAqBOhC,KAAKgC,OApBpB8D,EAAOnF,SAAS4B,cAAc,QAC/BY,UAAY,cACjBnB,EAAMW,SAAQ,SAAAoC,GAAG,OAAIA,EAAIpC,SAAQ,SAAAC,GAAI,OAAIkD,EAAKlC,YAAYhB,EAAKM,YACvD4C,GAkBRC,EAAOnC,YAAY5D,KAAK8F,MACxBC,EAAOnC,YAAYY,EAAU,SAAUxE,KAAKqD,MAAMoC,SAClDM,EAAOnC,YAAYY,EAAU,OAAQxE,KAAKqD,MAAMqC,OAChDtB,EAAUR,YAAYmC,GAEtB3B,EAAU4B,iBAAiB,WAAYhG,KAAKiG,gBAC5C7B,EAAU4B,iBAAiB,UAAWhG,KAAKkG,eAC3C9B,EAAU4B,iBAAiB,UAAWhG,KAAKmG,aAC3C/B,EAAU4B,iBAAiB,QAAShG,KAAKoG,aAEzCpG,KAAK8F,KAAKxC,MAAM+C,aAAhB,iBAAyCxB,EAAKyB,WAAWC,OAAzD,2BAAkF1B,EAAKyB,WAAWE,MAAlG,UACIrG,OAAOsG,WAAa,MACpBzG,KAAK8F,KAAKxC,MAAMkD,MAAiC,GAAxB3B,EAAKyB,WAAWE,MAAc,KACvDxG,KAAK8F,KAAKxC,MAAMiD,OAAmC,GAAzB1B,EAAKyB,WAAWC,OAAe,MAE7DvG,KAAK0G,sBAGT,IAAInC,EAASvE,KAEbA,KAAK2G,kBAAoB,SAAUjD,GAE/B,OADWa,EAAOvC,MAAMsD,OAAOK,MAAK,SAAA/C,GAAI,OAAIA,EAAKc,QAAUA,KAC/CL,OAGhBrD,KAAK4G,gBAAkB,WACnBrC,EAAOvC,MAAMsD,OAAO3C,SAAQ,SAAAC,GAAI,OAAIA,EAAKqB,qBAG7CjE,KAAKmG,YAAc,SAAUU,GACzB1G,OAAO2G,UAAW,EAClBvC,EAAOqC,kBACP,IAAIvD,EAAQkB,EAAOoC,kBAAkBE,EAAME,QACrC1D,EAAMkB,EAAOjD,YAAYiD,EAAOF,kBACtChB,EAAMkB,EAAOjD,WAAWmB,YACxBtC,OAAO6G,YAAW,kBAAM7G,OAAO2G,UAAW,IAAO,MAGrD9G,KAAKkG,cAAgB,SAAUW,GAC3BI,QAAQC,IAAIL,GACZI,QAAQC,IAAIlH,OAEhBA,KAAKiG,eAAiB,SAAUY,GAC5BI,QAAQC,IAAIL,GACZI,QAAQC,IAAIlH,OAEhBA,KAAKoG,YAAc,SAAUS,GACzB,IAAI1G,OAAO2G,UAAoC,SAAxBD,EAAME,OAAOI,QAApC,CACA,IAAI9D,EAAQkB,EAAOoC,kBAAkBE,EAAME,QACvC1D,EAAMoC,QAAUpC,EAAMqC,MAAMnB,EAAOF,kBACvCE,EAAOqC,kBACPvD,EAAMkB,EAAOjD,WAAWmB,cAG5BzC,KAAK0G,mBAAqB,SAAUG,GAChC,GAAKtC,EAAOuB,KAAZ,CACA,IAAIsB,EAAW5D,SAAS6D,iBAAiB9C,EAAOuB,KAAM,MAAMU,MAAMtF,QAAQ,KAAM,KAC5EoG,EAAWC,KAAKC,KAAKJ,GAAY,EAAI7C,EAAOvC,MAAM,GAAGhB,SAGrDsG,EAAW,IAAMA,EAAW,KAAIA,EAAW,IAC/C/C,EAAOuB,KAAK2B,iBAAiB,SAAS9E,SAAQ,SAAAe,GAAK,OAAIA,EAAMJ,MAAMgE,SAAWA,EAAW,QAEzF,IAAII,EAAgBH,KAAKC,KAAKJ,GAAY,IAAM7C,EAAOvC,MAAM,GAAGhB,SAChEuD,EAAOuB,KAAK2B,iBAAiB,oBAAoB9E,SAAQ,SAAAe,GAAK,OAAIA,EAAMJ,MAAMgE,SAAWI,EAAe,UAG5GvH,OAAO6F,iBAAiB,SAAUhG,KAAK0G,oBAgB3C,IAYWiB,EACHC,EAxMRxG,EAAKiE,MAAQ,SAAUwC,EAAUvG,GAC7B,IAAIG,EAAO,IAAIL,EAAKyG,EAAUvG,GAC9B,GAAIuG,EAASC,WAAaD,EAASC,UAAUhD,IAAK,CAC9CrD,EAAKM,cAAgB8F,EAASC,UAAUhD,KAAI,SAAAM,GAAC,cAAUhE,EAAKiE,MAAMD,IAArB,IAAyB5D,KAAM,OAAF,OAASqG,EAASnG,QAAUG,KAAMJ,OAC5G,IAAK,IAAIsG,EAAI,EAAGA,EAAItG,EAAKM,cAAcf,OAAS,EAAG+G,IAAKtG,EAAKM,cAAcgG,GAAGjG,KAAOL,EAAKM,cAAcgG,EAAI,GAEhH,OAAOtG,GA+LXtB,OAAO6H,SAVQ,SAAUC,GACrB,IAAI1D,EAAS,IAAIJ,EAAOxD,SAASuH,cAAcD,IAM/C,OALAjI,KAAKmI,KAAO,SAAUC,IAf1B,SAAaA,EAAKC,EAASC,EAASC,GAChC,IAAIC,EAAU,IAAIC,eAClBD,EAAQE,KAAK,MAAON,GAAK,GACzBI,EAAQG,OAAS,WAaJ,IAAUC,EAZfJ,EAAQK,QAAU,KAAOL,EAAQK,OAAS,MAY3BD,EAXPE,KAAKzD,MAAMmD,EAAQO,cAY3BxE,EAAOK,WAAWgE,KAP1BJ,EAAQQ,OAMJnJ,CAAIuI,IAIApI,MAKD2H,EAQRxH,OAPKyH,EAAQ,GACCzH,OAAOO,SAASuI,OAAO/H,QAAQ,MAAO,IAAIgI,MAAM,KACtDvG,SAAQ,SAAAwG,GACX,IAAIC,EAAOD,EAAMD,MAAM,KACvBtB,EAAMwB,EAAK,IAAMA,EAAK,MAE1BzB,EAAEC,MAAQA,EAjPlB,G,2BCAe,I","file":"ipuzzler.js","sourcesContent":["function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript)\n\t\tscriptUrl = document.currentScript.src\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) scriptUrl = scripts[scripts.length - 1].src\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","(function () {\r\n\r\n    function Clue(ipuzClueData, direction) {\r\n        this.direction = (direction || ipuzClueData.direction || \"\").toLowerCase();\r\n        if (ipuzClueData) {\r\n            this.text = ipuzClueData.clue || \"\";\r\n            this.number = ipuzClueData.number || 0;\r\n            this.enumeration = (ipuzClueData.enumeration || \"\").replace(/ /g, ',');\r\n            this.label = ipuzClueData.label || this.number;\r\n        }\r\n        this.root = null;\r\n        this.next = null;\r\n        this.continuations = [];\r\n        this.cells = [];\r\n        this.toClueList = _ => [this].concat(this.continuations);\r\n\r\n        this.toListItem = function () {\r\n            let html = `<a href=\"#\"><label>${this.label}</label>${this.text}`;\r\n            if (this.enumeration) html += ` <span>(${this.enumeration})</span>`;\r\n            html += \"</a>\";\r\n            const li = document.createElement('li');\r\n            li.innerHTML = html;\r\n            return (li);\r\n        }\r\n\r\n        this.highlight = function (depth = 0) {\r\n            if (depth == 0 && this.root) {\r\n                return this.root.highlight(depth + 1);\r\n            } else {\r\n                this.cells.forEach(cell => cell.highlight());\r\n                this.continuations.forEach(clue => clue.highlight(depth + 1));\r\n            }\r\n        }\r\n    }\r\n\r\n    Clue.parse = function (ipuzClue, direction) {\r\n        var clue = new Clue(ipuzClue, direction);\r\n        if (ipuzClue.continued && ipuzClue.continued.map) {\r\n            clue.continuations = ipuzClue.continued.map(c => ({ ...Clue.parse(c), text: `See ${ipuzClue.number}`, root: clue }));\r\n            for (var i = 0; i < clue.continuations.length - 1; i++) clue.continuations[i].next = clue.continuations[i + 1];\r\n        }\r\n        return clue;\r\n    }\r\n\r\n    function Cell(x, y, ipuzCellData) {\r\n        this.position = { x: x, y: y };\r\n        this.span = document.createElement('span');\r\n        this.span.className = 'cell';\r\n        this.previous = {};\r\n        this.next = {};\r\n        this.clues = {};\r\n        if (ipuzCellData === null) {\r\n            this.span.className += \" null\";\r\n        } else {\r\n            this.style = ipuzCellData.style || {};\r\n            if (ipuzCellData.style && ipuzCellData.style.barred) this.span.className += ' barred-' + ipuzCellData.style.barred.toLowerCase();\r\n            this.value = (ipuzCellData.cell || ipuzCellData);\r\n            if (parseInt(this.value)) this.span.insertAdjacentHTML('afterbegin', `<span class=\"clue-number\">${this.value}</span>`);\r\n            if (this.value == '#') {\r\n                this.span.className += \" block\";\r\n            } else {\r\n                this.input = document.createElement('input');\r\n                this.input.setAttribute('maxlength', '1');\r\n                this.input.cell = this;\r\n                this.span.appendChild(this.input);\r\n            }\r\n        }\r\n\r\n        this.isEndOfRange = function (direction) {\r\n            if (!this.input) return (true);\r\n            if (direction == \"across\" && /L/i.test(this.style.barred)) return true;\r\n            if (direction == \"down\" && /T/i.test(this.style.barred)) return true;\r\n            return false;\r\n        }\r\n\r\n        this.highlight = () => this.span.classList.add('current-clue');\r\n        this.clearHighlight = () => this.span.classList.remove('current-clue');\r\n\r\n    }\r\n\r\n    function Puzzle(container) {\r\n\r\n        this.direction = \"across\";\r\n\r\n        this.changeDirection = function () {\r\n            this.direction = (this.direction == \"across\" ? \"down\" : \"across\");\r\n        }\r\n\r\n        const parseCells = (ipuz) => ipuz.puzzle.map((row, y) => row.map((ipuzCell, x) => new Cell(x, y, ipuzCell)));\r\n\r\n        const findCluePosition = function (clue) {\r\n            return puzzle.cells.flat().find(cell => cell.value == clue.number).position;\r\n        }\r\n\r\n        const parseClues = function (ipuz) {\r\n            let cluesFromAcross = ipuz.clues.Across.map(c => Clue.parse(c, \"across\").toClueList()).flat();\r\n            let cluesFromDown = ipuz.clues.Down.map(c => Clue.parse(c, \"down\").toClueList()).flat();\r\n            const clues = { across: [], down: [] };\r\n            cluesFromAcross.concat(cluesFromDown).forEach(clue => {\r\n                clue.position = findCluePosition(clue);\r\n                clue.cells = listCells(clue.position.x, clue.position.y, clue.direction);\r\n                clue.cells.forEach(cell => cell.clues[clue.direction] = clue);\r\n                clues[clue.direction][clue.number] = clue;\r\n            });\r\n            return clues;\r\n        }\r\n\r\n        const listCells = function (x, y, direction, previous) {\r\n            if (y < 0 || x < 0 || y >= puzzle.cells.length || x >= puzzle.cells[y].length) return [];\r\n            var cell = puzzle.cells[y][x];\r\n            cell.previous[direction] = previous;\r\n            if (cell.isEndOfRange()) return [];\r\n            if (previous) previous.next[direction] = cell;\r\n            (direction == \"across\" ? x++ : y++);\r\n            return ([cell].concat(listCells(x, y, direction, cell)));\r\n        }\r\n\r\n        function drawGrid(cells) {\r\n            const grid = document.createElement('div');\r\n            grid.className = 'puzzle-grid';\r\n            cells.forEach(row => row.forEach(cell => grid.appendChild(cell.span)));\r\n            return (grid);\r\n        }\r\n\r\n        function drawClues(heading, clues) {\r\n            let div = document.createElement('div');\r\n            div.innerHTML = `<h2>${heading}</h2>`;\r\n            let ul = document.createElement(ul);\r\n            clues.forEach(clue => ul.appendChild(clue.toListItem()));\r\n            div.appendChild(ul);\r\n            return div;\r\n        }\r\n\r\n        this.drawPuzzle = function (ipuz) {\r\n            this.cells = parseCells(ipuz);\r\n            this.clues = parseClues(ipuz);\r\n            const layout = document.createElement('div');\r\n            layout.className = \"puzzle-layout\";\r\n            this.grid = drawGrid(this.cells);\r\n            layout.appendChild(this.grid);\r\n            layout.appendChild(drawClues(\"Across\", this.clues.across));\r\n            layout.appendChild(drawClues(\"Down\", this.clues.down));\r\n            container.appendChild(layout);\r\n\r\n            container.addEventListener(\"keypress\", this.handleKeyPress);\r\n            container.addEventListener(\"keydown\", this.handleKeyDown);\r\n            container.addEventListener(\"focusin\", this.handleFocus);\r\n            container.addEventListener(\"click\", this.handleClick);\r\n\r\n            this.grid.style.gridTemplate = `repeat(${ipuz.dimensions.height}, 1fr) / repeat(${ipuz.dimensions.width}, 1fr)`;\r\n            if (window.innerWidth > 768) {\r\n                this.grid.style.width = (ipuz.dimensions.width * 32) + \"px\";\r\n                this.grid.style.height = (ipuz.dimensions.height * 32) + \"px\";\r\n            }\r\n            this.handleWindowResize();\r\n        }\r\n\r\n        let puzzle = this;\r\n\r\n        this.findCluesForInput = function (input) {\r\n            let cell = puzzle.cells.flat().find(cell => cell.input === input);\r\n            return cell.clues;\r\n        }\r\n\r\n        this.clearHighlights = function () {\r\n            puzzle.cells.flat().forEach(cell => cell.clearHighlight());\r\n        }\r\n\r\n        this.handleFocus = function (event) {\r\n            window.focusing = true;\r\n            puzzle.clearHighlights();\r\n            let clues = puzzle.findCluesForInput(event.target);\r\n            if (! clues[puzzle.direction]) puzzle.changeDirection();\r\n            clues[puzzle.direction].highlight();\r\n            window.setTimeout(() => window.focusing = false, 200);\r\n        }\r\n\r\n        this.handleKeyDown = function (event) {\r\n            console.log(event);\r\n            console.log(this);\r\n        }\r\n        this.handleKeyPress = function (event) {\r\n            console.log(event);\r\n            console.log(this);\r\n        }\r\n        this.handleClick = function (event) {\r\n            if (window.focusing || event.target.tagName != \"INPUT\") return;\r\n            let clues = puzzle.findCluesForInput(event.target);\r\n            if (clues.across && clues.down) puzzle.changeDirection();\r\n            puzzle.clearHighlights();\r\n            clues[puzzle.direction].highlight();\r\n        }\r\n\r\n        this.handleWindowResize = function (event) {\r\n            if (!puzzle.grid) return;\r\n            let gridSize = parseInt(getComputedStyle(puzzle.grid, null).width.replace(\"px\", \"\"));\r\n            let fontSize = Math.ceil(gridSize / (2 * puzzle.cells[0].length));\r\n\r\n            // for sizes just under 16, we bump the size to 16px to prevent zooming on iOS when input is focused.\r\n            if (fontSize > 10 && fontSize < 16) fontSize = 16;\r\n            puzzle.grid.querySelectorAll(\"input\").forEach(input => input.style.fontSize = fontSize + \"px\");\r\n\r\n            let clueFontSize = (Math.ceil(gridSize / (3.5 * puzzle.cells[0].length)));\r\n            puzzle.grid.querySelectorAll(\"span.clue-number\").forEach(input => input.style.fontSize = clueFontSize + \"px\");\r\n        }\r\n\r\n        window.addEventListener(\"resize\", this.handleWindowResize);\r\n    }\r\n\r\n    function get(url, success, failure, error) {\r\n        var request = new XMLHttpRequest();\r\n        request.open('GET', url, true);\r\n        request.onload = function () {\r\n            if (request.status >= 200 && request.status < 400) {\r\n                success(JSON.parse(request.responseText));\r\n            } else {\r\n                if (failure) failure();\r\n            }\r\n        };\r\n        request.send();\r\n    }\r\n\r\n    let ipuzzler = function (selector) {\r\n        let puzzle = new Puzzle(document.querySelector(selector));\r\n        this.load = function (url) {\r\n            get(url, function (data) {\r\n                puzzle.drawPuzzle(data);\r\n            });\r\n        }\r\n        return (this);\r\n    }\r\n\r\n    window.ipuzzler = ipuzzler;\r\n\r\n    (function (w) {\r\n        let query = {};\r\n        let tokens = window.location.search.replace(/^\\?/, '').split('&');\r\n        tokens.forEach(token => {\r\n            let pair = token.split('=');\r\n            query[pair[0]] = pair[1];\r\n        });\r\n        w.query = query;\r\n    })(window);\r\n\r\n})();","export default __webpack_public_path__ + \"ipuzzler.css\";"],"sourceRoot":""}